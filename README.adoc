= Learn Bluespec and RISC-V Design
(c) Rishiyur S. Nikhil, Bluespec, Inc. 2024
:revnumber: v0.965
:revdate: 2024-03-10.A
:sectnums:
:THIS_FILE: README
:RELEASE: 2024-03-10.A
// :toc:
// :toclevels: 3
// :toc-title: Contents
:keywords: Bluespec, B-Lang, BSV, BH, RISC-V, Pipelined CPU, HDL, HLHDL, High Level Hardware Design Language, Fife, Drum

// ****************************************************************

image::Figures/Fig_Under_Construction.png[align="left", width=100]

This is an early release of work-in-progress, for the convenience of
early reviewers. Expected availability of first draft: mid- to
late-March 2024. Until then, this repo may be updated on a daily (or
more frequent) basis.

[NOTE]
====
This document's source is `{THIS_FILE}.adoc` and can be read as-is
in a text-editor or terminal.  It can also be processed with the free,
open-source `asciidoctor` tool into `{THIS_FILE}.html`, viewable in
any browser.
====

// ****************************************************************

== Introduction

This repository contains free and open source material for learning
the *BSV* High-Level Hardware Design Language (HLHDL), and for
learning how to design a simple pipelined implementation of a RISC-V
CPU.

There are two target audiences:

* Learn general principles of designing a RISC-V pipelined CPU (5+
  stages, mostly in-order).

** As a consequence, learn digital design using Bluespec BSV.

* Learn digital hardware design using Bluespec BSV.

** As a consequence, learn how to design a pipelined RISC-V CPU, which
   is used as a running example.

The materials consist of a textbook and complete BSV source codes that
can be compiled to run in a Verilog simulator.  The generated Verilog
is also synthesizable for FPGAs, but needs to be attached to at least
a memory and preferably also to a UART.

This repo has one or more timestamped release directories, such as
{RELEASE} with sub-directories `Book` and `Code`.

----
    ├── Book
    └── Code
----

The textbook is in subdirectory `Book/` at
link:{RELEASE}/Book/Book_BLang_RISCV.pdf[`Book/Book_BLang_RISCV.pdf`].

The source codes are in subdirectory `Code/`.  This includes includes
`Doc/Build_and_Run_Guide.adoc` that explains how to compile and run
the Drum and Fife source codes (using a Verilog simulator) using free
and open-source tools.

The book and code are synchronized for each release---the actual
source code is excerpted in descriptions in the book.

NOTE: For Haskell enthusiasts: a possible future edition of this book
      could present the same material using BSV's sister language *BH*
      which has Haskell-like syntax.  BSV an BH both use Haskell's
      type system (polymorphic types, algebraic types, typeclasses,
      monadic types and monads).

// ****************************************************************

== About RISC-V and BSV

RISC-V is an open-standard ISA (Instruction-Set Architecture).  ISA
specification documents can be found at
https://riscv.org/technical/specifications/[].  The site
https://riscv.org/[] also contains much additional useful material, in
particular information on GNU compilation/debugging tools gcc, gdb,
etc.

Bluespec BSV is a free, open-source HLHDL (High-Level Hardware Design
Language), a significant improvement in expressive power and
simplicity compared to Verilog/SystemVerilog/VHDL.  Its free,
open-source compiler is available at:
link:https://github.com/B-Lang-org/bsc[].  An appendix in the book
explores "Why BSV?" in more detail.

// ****************************************************************

== About the pedagogic approach

We describe the design of two RISC-V CPU implementations, in this order:

* *Drum*, an "FSM" implementation, which almost looks like a software
  RISC-V simulator written in C, except that it is fully synthesizable
  and runnable on FPGAs.

* *Fife*, a 5+ stage, mostly in-order, pipelined implementation,
  including simple branch prediction, scoreboarding, in-order
  retirement, and speculative STOREs with a store-buffer.

The two implementations share _all_ the functional parts of RISC-V
code, which are covered in the first part of the book, with *Drum*.
By the time we reach the second part of the book, on *Fife*, we focus
purely on pipelining questions, since all RISC-V-specific semantics
have already been covered with *Drum*.

The book interleaves RISC-V topics and BSV topics in an incremental
and mutually reinforcing way, and describes the full design process
and the code in detail.  We hope to avoid steep learning curves for
BSV and for RISC-V.

The book and the two implementations focus on the "RV32I" subset of
the RISC-V Unprivileged ISA specification, plus a few features from
the Privileged specification sufficient to to handle illegal
instructions and other traps, and interrupts.  This is adequate for
small embedded systems.  A discussion at the end of the book suggests
how to extend Drum and Fife to Linux-capability (RV64I, A,M,F,D,C
extensions, virtual memory, interrupts, etc.).  Please contact the
author to see if any materials become available on these topics in the
future.

// ================================================================

=== Feedback welcome

The author welcomes feedback on this material: specifically errata,
but more generally on the pedagogic experience.

// ****************************************************************
